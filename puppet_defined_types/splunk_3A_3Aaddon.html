<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Defined Type: splunk::addon
  
    &mdash; Documentation by YARD 0.9.19
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "puppet_defined_types::splunk::addon";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../puppet_defined_type_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (s)</a> &raquo;
    <span class='title'><span class='object_link'>Defined Types</span></span>
     &raquo; 
    <span class="title">splunk::addon</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="../puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Defined Type: splunk::addon</h1>
<div class="box_info">
  <dl>
    <dt>Defined in:</dt>
    <dd>
      manifests/addon.pp
    </dd>
  </dl>
</div>

  <h2>Summary</h2>
  Defined type for deploying Splunk Add-ons and Apps from either OS packages
or via splunkbase compatible archives

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">
    
  </div>
</div>


<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Basic usage</p>
</div></p>
      
      <pre class="example code"><code>splunk::addon { &#39;Splunk_TA_nix&#39;:
  splunkbase_source =&gt; &#39;puppet:///modules/splunk_qd/addons/splunk-add-on-for-unix-and-linux_602.tgz&#39;,
  inputs            =&gt; {
    &#39;monitor:///var/log&#39;       =&gt; {
     &#39;whitelist&#39; =&gt; &#39;(\.log|log$|messages|secure|auth|mesg$|cron$|acpid$|\.out)&#39;,
     &#39;blacklist&#39; =&gt; &#39;(lastlog|anaconda\.syslog)&#39;,
     &#39;disabled&#39;  =&gt; &#39;false&#39;
    },
    &#39;script://./bin/uptime.sh&#39; =&gt;  {
      &#39;disabled&#39; =&gt; &#39;false&#39;,
      &#39;interval&#39; =&gt; &#39;86400&#39;,
      &#39;source&#39; =&gt; &#39;Unix:Uptime&#39;,
      &#39;sourcetype&#39; =&gt; &#39;Unix:Uptime&#39;
    }
  }
}</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>splunk_home</span>
      
      
        <span class='type'>(<tt>Optional[Stdlib::Absolutepath]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Overrides the default Splunk installation target values from Class[splunk::params]</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>package_manage</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>If a package should be installed as part of declaring a new instance of Splunk::Addon</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>splunkbase_source</span>
      
      
        <span class='type'>(<tt>Optional[String[1]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>When set the add-on will be installed from a splunkbase compatible archive instead of OS packages</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>package_name</span>
      
      
        <span class='type'>(<tt>Optional[String[1]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The OS package to install if you are not installing via splunk compatible archive</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>inputs</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>A hash of inputs to be configured as part of add-on installation, alterntively you can also define splunk_input or splunkforwarder_input resouces seperately</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://docs.splunk.com/Documentation/AddOns/released/Overview/AboutSplunkadd-ons" target="_parent" title="https://docs.splunk.com/Documentation/AddOns/released/Overview/AboutSplunkadd-ons">https://docs.splunk.com/Documentation/AddOns/released/Overview/AboutSplunkadd-ons</a></li>
    
  </ul>

</div><div class="method_details_list">
  <table class="source_code">
    <tr>
      <td>
        <pre class="lines">


40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116</pre>
      </td>
      <td>
        <pre class="code"><span class="info file"># File 'manifests/addon.pp', line 40</span>

define splunk::addon (
  Optional[Stdlib::Absolutepath] $splunk_home = undef,
  Boolean $package_manage                     = true,
  Optional[String[1]] $splunkbase_source      = undef,
  Optional[String[1]] $package_name           = undef,
  Hash $inputs                                = {},
) {

  include splunk::params

  if defined(Class[&#39;splunk::forwarder&#39;]) {
    $mode = &#39;forwarder&#39;
  } else {
    $mode = &#39;enterprise&#39;
  }

  if $splunk_home {
    $_splunk_home = $splunk_home
  }
  else {
    case $mode {
      &#39;forwarder&#39;:  { $_splunk_home = $splunk::params::forwarder_homedir }
      &#39;enterprise&#39;: { $_splunk_home = $splunk::params::enterprise_homedir }
      default:      { fail(&#39;Instances of Splunk::Addon require the declaration of one of either Class[splunk::enterprise] or Class[splunk::forwarder]&#39;) }
    }
  }

  if $package_manage {
    if $splunkbase_source {
      $archive_name = $splunkbase_source.split(&#39;/&#39;)[-1]
      archive { $name:
        path         =&gt; &quot;${splunk::params::staging_dir}/${archive_name}&quot;,
        source       =&gt; $splunkbase_source,
        extract      =&gt; true,
        extract_path =&gt; &quot;${_splunk_home}/etc/apps&quot;,
        creates      =&gt; &quot;${_splunk_home}/etc/apps/${name}&quot;,
        cleanup      =&gt; true,
        before       =&gt; File[&quot;${_splunk_home}/etc/apps/${name}/local&quot;],
      }
    } else {
      package { $package_name:
        ensure =&gt; installed,
        before =&gt; File[&quot;${_splunk_home}/etc/apps/${name}/local&quot;],
      }
    }
  }

  file { &quot;${_splunk_home}/etc/apps/${name}/local&quot;: ensure =&gt; directory }

  unless $inputs.empty {
    $inputs.each |$section, $attributes| {
      $attributes.each |$setting, $value| {
        case $mode {
          &#39;forwarder&#39;: {
            splunkforwarder_input { &quot;${name}_${section}_${setting}&quot;:
              section =&gt; $section,
              setting =&gt; $setting,
              value   =&gt; $value,
              context =&gt; &quot;apps/${name}/local&quot;,
              require =&gt; File[&quot;${_splunk_home}/etc/apps/${name}/local&quot;],
            }
          }
          &#39;enterprise&#39;: {
            splunk_input { &quot;${name}_${section}_${setting}&quot;:
              section =&gt; $section,
              setting =&gt; $setting,
              value   =&gt; $value,
              context =&gt; &quot;apps/${name}/local&quot;,
              require =&gt; File[&quot;${_splunk_home}/etc/apps/${name}/local&quot;],
            }
          }
          default: { fail(&#39;Instances of Splunk::Addon require the declaration of one of either Class[splunk::enterprise] or Class[splunk::forwarder]&#39;) }
        }
      }
    }
  }
}</pre>
      </td>
    </tr>
  </table>
</div>
</div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>